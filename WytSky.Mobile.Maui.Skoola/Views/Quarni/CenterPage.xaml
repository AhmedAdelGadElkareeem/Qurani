<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="WytSky.Mobile.Maui.Skoola.Views.Quarni.CenterPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:behaviors="clr-namespace:WytSky.Mobile.Maui.Skoola.Behaviors"
    xmlns:customControl="clr-namespace:WytSky.Mobile.Maui.Skoola.CustomControl.Borderless"
    xmlns:customControls="clr-namespace:WytSky.Mobile.Maui.Skoola.CustomControl"
    xmlns:resource="clr-namespace:WytSky.Mobile.Maui.Skoola.AppResources"
    xmlns:templates="clr-namespace:WytSky.Mobile.Maui.Skoola.Template"
    x:Name="root"
    Title="CenterPage"
    IconImageSource="filter">
    <VerticalStackLayout>

        <!--  Back Button  -->
        
        <Grid Padding="10">
            <ImageButton
                BackgroundColor="Transparent"
                Clicked="OnBackButtonClicked"
                HeightRequest="20"
                HorizontalOptions="Start"
                Source="back_arrow.svg"
                WidthRequest="15" />
        </Grid>

        <CollectionView
            x:Name="parentCategories"
            Margin="15,10,15,0"
            ItemsSource="{Binding Centers}">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout ItemSpacing="15" Orientation="Vertical" />
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame
                        Padding="0"
                        BackgroundColor="{Binding BackgroundColor}"
                        BorderColor="{StaticResource BorderColor}"
                        CornerRadius="5">
                        <Label
                            Margin="15,5"
                            HorizontalOptions="CenterAndExpand"
                            HorizontalTextAlignment="Center"
                            Style="{StaticResource BoldLabelFont16}"
                            Text="{Binding CenterName}"
                            TextColor="{Binding TextColor}" />

                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type CollectionView}}, Path=BindingContext.SelectParentCategoryCommand}" CommandParameter="{Binding .}" />
                        </Frame.GestureRecognizers>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            <CollectionView.EmptyView>
                <customControls:EmptyView />
            </CollectionView.EmptyView>
        </CollectionView>
        <Grid Padding="15" VerticalOptions="End">
            <Frame
                x:Name="ComplexEntryLayout"
                Padding="15"
                BackgroundColor="White"
                CornerRadius="20"
                IsVisible="{Binding IsComplexEntryVisible, Mode=TwoWay}">
                <VerticalStackLayout>
                    <Label
                        FontAttributes="Bold"
                        FontSize="16"
                        Text="أدخل اسم المسجد" />

                    <!--  Entry for Complex Name  -->
                    <Entry
                        x:Name="ComplexNameEntry"
                        BackgroundColor="White"
                        Placeholder="إسم المسجد"
                        Text="{Binding CentersModel.CenterName, Mode=TwoWay}"
                        TextColor="Black" />

                    <!--<Label
                        FontAttributes="Bold"
                        FontSize="16"
                        Text="Enter Complex ID:" />

                    -->
                    <!--  Entry for Complex ID  -->
                    <!--
                    <Entry
                        x:Name="ComplexIDEntry"
                        BackgroundColor="LightGray"
                        Placeholder="Type complex ID..."
                        Text="{Binding CentersModel.ComplexID, Mode=TwoWay}"
                        TextColor="Black" />-->

                    <Label
                        FontAttributes="Bold"
                        FontSize="16"
                        Text="أدخل العنوان:" />

                    <!--  Entry for City  -->
                    <Entry
                        x:Name="CityEntry"
                        BackgroundColor="White"
                        Placeholder="أسم الحـى"
                        Text="{Binding CentersModel.Address, Mode=TwoWay}"
                        TextColor="Black" />

                    <!--  Button to Add Complex  -->
                    <Button
                        Margin="0,10,0,0"
                        Padding="10"
                        BackgroundColor="Blue"
                        Command="{Binding AddCenterCommand}"
                        Text="➕ Add Complex"
                        TextColor="White" />
                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!--  Floating Action Button (FAB) to Open Form  -->
        <Button
            x:Name="FlyoutButton"
            Grid.RowSpan="2"
            Margin="20"
            BackgroundColor="White"
            Clicked="OnFlyoutButtonClicked"
            CornerRadius="30"
            FontSize="18"
            HeightRequest="60"
            HorizontalOptions="End"
            Text="➕ Add"
            TextColor="Blue"
            VerticalOptions="End"
            WidthRequest="60" />

    </VerticalStackLayout>
</ContentPage>